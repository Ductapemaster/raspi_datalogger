<!doctype html>
<html lang="en">
<title>{{ title }}</title>
  <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script type="text/javascript">
            google.charts.load('current', {'packages':['corechart']});

            // Set a callback to run when the Google Visualization API is loaded.
            google.charts.setOnLoadCallback(drawChart);

            function create_chart(measurement_type, chartElementId, title, start, end){
                return $.ajax({
                    url: "data?type=" + measurement_type + '&start=' + start + '&end=' + end,
                    dataType: "json",
                    success: function(json) {
                        var data = new google.visualization.DataTable(json);
                        var chart =  new google.visualization.LineChart(document.getElementById(chartElementId));
                        options = {
                            title:      title,
                            lineWidth:  0,
                            pointSize:  3,
                            width:      600,
                            height:     300,
                            legend:     'none',
                            chartArea: {'width': '80%', 'height': '80%'},
                        };
                        chart.draw(data, options);
                    }
                }).responseText;
            }

            function drawChart() {
                end = new Date();
                start = new Date(end.getTime());
                start.setDate(start.getDate() - 1);

                {% for plot in plots %}
                create_chart('{{ plot.measurement_type }}',
                             'chart_{{ plot.measurement_type }}',
                             '{{ plot.content_title }}',
                             start.getTime(),
                             end.getTime());
                {% endfor %}
            }
        </script>
        {% block header %}{% endblock %}
    </head>

</section>

<body>

<nav class="navbar navbar-dark bg-dark">
    <a class="navbar-brand" href="#">Sensor Dashboard</a>
</nav>

<center>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm" style="padding-top: 20px"><div id="chart_temperature"></div></div>
            <div class="col-sm" style="padding-top: 20px"><div id="chart_humidity"></div></div>
        </div>
        <div class="row">
            <div class="col-sm" style="padding-top: 20px"><div id="chart_pressure"></div></div>
            <div class="col-sm" style="padding-top: 20px"><div id="chart_co2"></div></div>
        </div>
    </div>
</center>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

</body>
</html>