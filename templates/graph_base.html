<!doctype html>
<title>{{ title }}</title>
<section class="content">
    <header>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script type="text/javascript">
            google.charts.load('current', {'packages':['corechart']});

            // Set a callback to run when the Google Visualization API is loaded.
            google.charts.setOnLoadCallback(drawChart);

            function query_chart_data(measurement_type){
                return $.ajax({
                    url: "data?type=" + measurement_type,
                    dataType: "json",
                    async: false
                }).responseText;
            }

            function drawChart() {
                {% for plot in plots %}
                var jsonData_{{ plot.id }} = query_chart_data("{{ plot.measurement_type }}");

                // Create our data table out of JSON data loaded from server.
                var data_{{ plot.id }} = new google.visualization.DataTable(jsonData_{{ plot.id }});

                var chart_{{ plot.id }} = new google.visualization.LineChart(document.getElementById('chart_{{ plot.id }}'));

                var options = {
                    title:      '{{ plot.content_title }}',
                    lineWidth:  0,
                    pointSize:  3,
                    width:      600,
                    height:     300,
                    legend:     'none',
                };

                chart_{{ plot.id }}.draw(data_{{ plot.id }}, options);
                {% endfor %}
            }
        </script>
        {% block header %}{% endblock %}
    </header>

</section>

<body>

<center>
    <h1>Sensor Dashboard</h1>
    <table class="columns">
        <tr>
            <td><div id="chart_1" style="border: 1px solid #ccc"></div></td>
            <td><div id="chart_2" style="border: 1px solid #ccc"></div></td>
        </tr>
        <tr>
            <td><div id="chart_3" style="border: 1px solid #ccc"></div></td>
            <td><div id="chart_4" style="border: 1px solid #ccc"></div></td>
      </tr>
    </table>
</center>
</body>